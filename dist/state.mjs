var w=function(n,t){let e=Math.min(n.length,t.length),i=n.slice(0,e),s=t.slice(0,e),o=0,r=0;for(;r<e&&o==0;)o=Math.sign(i[r]-s[r]),r++;return o},$=function(){this.pool=[],this.point=function(n,t=!1){if(this.pool.length>0){let e=this.pool.length,i=1<<Math.floor(Math.log2(e)),s=i,o=64;for(;i>=1&&o>=0;){if(o<=0)throw new Error("TTL reached.");if(s==e)s-=i;else{let c=w(n,this.pool[s]);switch(c){case 0:{o=0;break}case 1:{s+i<=e&&(s+=i);break}case-1:{s!=0&&(s-=i);break}default:console.warn(`Unexpected result ${c}.`)}}i=i>>1,o--}let r=!0;if(s>=this.pool.length)r=!1;else{let c=this;this.pool[s].forEach(function(a,l,u){r&&a!=n[l]&&(r=!1)}),!r&&w(n,this.pool[s])>0&&s++}return r||t?s:-1}else return t?0:-1},this.add=function(n,t){return n.data=t,this.pool.splice(this.point(n,!0),0,n),this},this.default=function(n){console.warn(`No match for "${n}". Default action not defined.`)},this.get=function(n){let t=this.point(n);if(t>-1)return this.pool[t].data;this.default(n)},this.run=function(n,...t){let e=this.point(n);e>-1?this.pool[e].data(n.slice(this.pool[e].length),...t):this.default(n,...t)}};var v=class{#n={};addEventListener(n,t){this.#n[n]||(this.#n[n]=[]),this.#n[n].unshift(t)}removeEventListener(n,t){if(this.#n[n]){let e=this.#n[n].indexOf(t);e>-1&&this.#n[n].splice(e,1),this.#n[n].length<1&&delete this.#n[n]}}dispatchEvent(n,t){let e=new Event(n),i=this;e.data=t,this.#n[n]?.length>0&&this.#n[n].forEach(function(s){s?.call(i,e)}),this[`on${n}`]&&this[`on${n}`](e)}};var f=["off","hall","room","stage","plate","delay LCR","delay LR","echo","cross delay","early reflections","gate reverb","reverse gate"];f[16]="white room";f[17]="tunnel";f[19]="basement";f[20]="karaoke";f[64]="pass through";f[65]="chorus";f[66]="celeste";f[67]="flanger";f[68]="symphonic";f[69]="rotary speaker";f[70]="tremelo";f[71]="auto pan";f[72]="phaser";f[73]="distortion";f[74]="overdrive";f[75]="amplifier";f[76]="3-band EQ";f[77]="2-band EQ";f[78]="auto wah";var X=["melodic","drum","drum set 1","drum set 2"],P=[17.1,18.6,20.2,21.8,23.3,24.9,26.5,28,29.6,31.2,32.8,34.3,35.9,37.5,39,40.6,42.2,43.7,45.3,46.9,48.4,50],g=[20,22,25,28,32,36,40,45,50,56,63,70,80,90,100,110,125,140,160,180,200,225,250,280,315,355,400,450,500,560,630,700,800,900,1e3,1100,1200,1400,1600,1800,2e3,2200,2500,2800,3200,3600,4e3,4500,5e3,5600,6300,7e3,8e3,9e3,1e4,11e3,12e3,14e3,16e3,18e3,2e4],E=[0,.04,.08,.13,.17,.21,.25,.29,.34,.38,.42,.46,.51,.55,.59,.63,.67,.72,.76,.8,.84,.88,.93,.97,1.01,1.05,1.09,1.14,1.18,1.22,1.26,1.3,1.35,1.39,1.43,1.47,1.51,1.56,1.6,1.64,1.68,1.72,1.77,1.81,1.85,1.89,1.94,1.98,2.02,2.06,2.1,2.15,2.19,2.23,2.27,2.31,2.36,2.4,2.44,2.48,2.52,2.57,2.61,2.65,2.69,2.78,2.86,2.94,3.03,3.11,3.2,3.28,3.37,3.45,3.53,3.62,3.7,3.87,4.04,4.21,4,37,4.54,4.71,4.88,5.05,5.22,5.38,5.55,5.72,6.06,6.39,6.73,7.07,7.4,7.74,8.08,8.41,8.75,9.08,9.42,9.76,10.1,10.8,11.4,12.1,12.8,13.5,14.1,14.8,15.5,16.2,16.8,17.5,18.2,19.5,20.9,22.2,23.6,24.9,26.2,27.6,28.9,30.3,31.6,33,34.3,37,39.7],M=function(n){let t=.1,e=-.3;return n>66?(t=5,e=315):n>56?(t=1,e=47):n>46&&(t=.5,e=18.5),t*n-e},k=function(n){return n>105?P[n-106]:n>100?n*1.1-100:n/10};var R=["room 1","room 2","room 3","hall 1","hall 2","plate","delay","panning delay"],y=["chorus 1","chorus 2","chorus 3","chorus 4","feedback","flanger","short delay","short delay feedback"];var h=function(n=64){return Math.round(2e3*Math.log10(n/64))/100},m=function(n,t){let e=0;for(let i=0;i<n.length;i++)i%8!=0&&(t(n[i],e,n),e++)},b=function(n){return Math.floor(n*14.2)};var G=["?","gm","gs","xg","g2","mt32","ns5r","ag10","x5d","05rw"],p={};G.forEach(function(n,t){p[n]=t});var S=[[0,0,0,0,121,0,0,56,82,81],[0,0,1,0,0,127,0,0,0,0]],x=[120,127,120,127,120,127,61,62,62,62],D=[0,3,81,84,88],N=[8,9,10,32,33,36,37,99,100,101];var d=function(n,t,e){e[t]=0},T=function(n){let t=[[]];return n?.forEach(function(e){e==247||(e==240?t.push([]):t[t.length-1].push(e))}),t},C=function(n,t="",e="",i=2){return n?`${t}${n.toString().padStart(i,"0")}${e}`:""},V=class extends v{#n=0;#E=new Array(256);#M=0;#l=new Uint8Array(64);#G=new Uint8Array(64);#t=new Uint8ClampedArray(8192);#$=new Uint8ClampedArray(64);#f=new Uint8ClampedArray(8192);#r=new Uint16Array(256);#P=new Int16Array(64);#k=new Array(64);#p=new Uint8Array(64);#R=0;#d=new Uint8Array(256);#D=new Int8Array(640);#y=0;#w=0;#v=100;#m=0;#b="";#S=0;#s=!1;#e=[];#u=new Uint8Array(32);#X=new Uint8Array(128);chRedir(n,t,e){if([p.gs,p.ns5r].indexOf(this.#n)>-1){if(this.#X[t])return(this.#X[t]-1)*16+n;if(e)return n;let i=0;return this.#u[n]==0?(this.#u[n]=t,console.debug(`Assign track ${t} to channel ${n+1}.`)):this.#u[n]!=t&&(i=16,this.#u[n+i]==0?(this.#u[n+i]=t,console.debug(`Assign track ${t} to channel ${n+i+1}.`)):this.#u[n+i]!=t&&(i=0)),n+i}else return n}#c=[];#x;#N={8:function(n){let t=this.chRedir(n.part,n.track),e=this;this.#G.forEach(function(i,s){if(i==t){let r=e.chRedir(s,n.track)*128+n.data[0],c=e.#r.indexOf(r);c>-1&&(e.#r[c]=0,e.#f[r]=0)}})},9:function(n){let t=this.chRedir(n.part,n.track),e=this;this.#G.forEach(function(i,s){if(i==t){let o=e.chRedir(s,n.track);e.#l[o]=1;let r=o*128+n.data[0];if(n.data[1]>0){let c=0;for(;e.#r[c]>0;)c++;c<256?(e.#r[c]=r,e.#f[r]=n.data[1],e.#p[o]<n.data[1]&&(e.#p[o]=n.data[1])):console.error("Polyphony exceeded.")}else{let c=e.#r.indexOf(r);c>-1&&(e.#r[c]=0,e.#f[r]=0)}}})},10:function(n){let e=this.chRedir(n.part,n.track)*128+n.data[0];this.#r.indexOf(e)>-1&&(this.#f[e]=data[1])},11:function(n){let t=this.chRedir(n.part,n.track);this.#G.forEach((e,i)=>{if(e==t){let s=this.chRedir(i,n.track);this.#l[s]=1;let o=s*128;switch(n.data[0]){case 0:{if(this.#n==p.gs||this.#n==0)n.data[1]<48?(this.#t[o]>119&&(n.data[1]=this.#t[o],this.#n||(n.data[1]=120,console.debug(`Forced channel ${s+1} to stay drums.`))),n.data[1]>0&&(console.debug(`Roland GS detected with MSB: ${n.data[1]}`),this.switchMode("gs"))):n.data[1]==62&&this.switchMode("x5d");else if(this.#n==p.gm)n.data[1]<48&&this.#t[o]>119&&(n.data[1]=120,this.switchMode("gs",!0),console.debug(`Forced channel ${s+1} to stay drums.`));else if(this.#n==p.x5d){if(n.data[1]>0&&n.data[1]<8)this.switchMode("05rw",!0);else if(n.data[1]==56){let r=0;for(let c=0;c<16;c++){let a=this.#t[128*c];(a==56||a==62)&&r++}r>14&&this.switchMode("ag10",!0)}}break}case 6:{if(this.#R){if(this.#t[o+99]==1){let r=N.indexOf(this.#t[o+98]);r>-1&&(this.#D[s*10+r]=n.data[1]-64)}}else this.#t[o+101]==0&&this.#t[o+100]<3&&(this.#d[s*4+[0,1,3][this.#t[o+100]]]=n.data[1]);break}case 38:{this.#R||this.#t[o+101]==0&&this.#t[o+100]==1&&(this.#d[s*4+2]=n.data[1]);break}case 98:case 99:{this.#R=1;break}case 100:case 101:{this.#R=0;break}}this.#t[o+n.data[0]]=n.data[1]}})},12:function(n){let t=this.chRedir(n.part,n.track);this.#l[t]=1,this.#$[t]=n.data,this.#k[t]=0},13:function(n){let t=this,e=this.chRedir(n.part,n.track);this.#r.forEach(function(i){let s=i>>7;e==s&&(t.#f[i]=n.data)})},14:function(n){let t=this.chRedir(n.part,n.track);this.#P[t]=n.data[1]*128+n.data[0]-8192},15:function(n){let t=this;T(n.data).forEach(function(e){t.#h.run(e,n.track)})},255:function(n){if((this.#c[n.meta]||function(e,i,s){}).call(this,n.data,n.track,n.meta),n.meta!=32&&(this.#m=0),D.indexOf(n.meta)>-1)return n.reply="meta",n;self.debugMode&&console.debug(n)}};#h;#i;#o;#C;#g;#a;getActive(){let n=this.#l.slice();return this.#n==p.mt32&&(n[0]=0),n}getCc(n){let t=n*128,e=this.#t.slice(t,t+128);return e[0]=e[0]||this.#y,e[32]=e[32]||this.#w,e}getCcAll(){let n=this.#t.slice();for(let t=0;t<64;t++){let e=t*128;n[e]=n[e]||this.#y,n[e+32]=n[e+32]||this.#w}return n}getPitch(){return this.#P}getProgram(){return this.#$}getTexts(){return this.#e.slice()}getVel(n){let t=new Map,e=this;return this.#r.forEach(function(i){let s=Math.floor(i/128),o=i%128;n==s&&e.#f[i]>0&&t.set(o,e.#f[i])}),t}getBitmap(){return{bitmap:this.#E,expire:this.#M}}getCustomNames(){return this.#k.slice()}getLetter(){return{text:this.#b,expire:this.#S}}getMode(){return G[this.#n]}getMaster(){return{volume:this.#v}}getRawStrength(){let n=this;return this.#r.forEach(function(t){let e=Math.floor(t/128);n.#f[t]>n.#p[e]&&(n.#p[e]=n.#f[t])}),this.#p}getStrength(){let n=[],t=this;return this.getRawStrength().forEach(function(e,i){n[i]=Math.floor(e*t.#t[i*128+7]*t.#t[i*128+11]*t.#v/803288)}),n}getRpn(){return this.#d}getNrpn(){return this.#D}init(){this.dispatchEvent("mode","?"),this.#n=0,this.#y=0,this.#w=0,this.#m=0,this.#l.forEach(d),this.#t.forEach(d),this.#$.forEach(d),this.#f.forEach(d),this.#r.forEach(d),this.#p.forEach(d),this.#P.forEach(d),this.#D.forEach(d),this.#v=100,this.#e=[],this.#S=0,this.#b="",this.#M=0,this.#E.forEach(d),this.#k.forEach(d),this.#s=!1,this.#G.forEach(function(n,t,e){e[t]=t}),this.#u.forEach(d),this.#X.forEach(d),this.#t[1152]=127,this.#t[3200]=127,this.#t[5248]=127,this.#t[7296]=127;for(let n=0;n<64;n++){let t=n*128;this.#t[t+7]=127,this.#t[t+11]=127,this.#t[t+74]=127,this.#t[t+10]=64,this.#t[t+101]=127,this.#t[t+100]=127,this.#t[t+99]=127,this.#t[t+98]=127;let e=n*4;this.#d[e]=2,this.#d[e+1]=64,this.#d[e+2]=0,this.#d[e+3]=64}}switchMode(n,t=!1){let e=G.indexOf(n);if(e>-1){if(this.#n==0||t){this.#n=e,this.#y=S[0][e],this.#w=S[1][e];for(let i=0;i<64;i++)x.indexOf(this.#t[i*128])>-1&&(this.#t[i*128]=x[e]);this.dispatchEvent("mode",n)}}else throw new Error(`Unknown mode ${n}`)}newStrength(){this.#p.forEach(d)}runJson(n){return this.#N[n.type].call(this,n)}runRaw(n){}constructor(){super();let n=this;this.#x=new $,this.#h=new $,this.#i=new $,this.#o=new $,this.#C=new $,this.#g=new $,this.#a=new $,this.#x.default=function(t,e){console.debug(`Unparsed meta 127 sequence on track ${e}: `,t)},this.#h.default=function(t){console.debug("Unparsed SysEx: ",t)},this.#i.default=function(t,e){console.debug(`Unparsed GS Part on channel ${e}: `,t)},this.#C.default=function(t,e){console.debug(`Unparsed XG Part on channel ${e}: `,t)},this.#g.default=function(t,e){console.debug(`Unparsed XG Drum Part on channel ${e}: `,t)},this.#c[1]=function(t){switch(t.slice(0,2)){case"@I":{this.#s=!0,this.#e.unshift(`Kar.Info: ${t.slice(2)}`);break}case"@K":{this.#s=!0,this.#e.unshift("Karaoke mode active."),console.debug(`Karaoke mode active: ${t.slice(2)}`);break}case"@L":{this.#s=!0,this.#e.unshift(`Language: ${t.slice(2)}`);break}case"@T":{this.#s=!0,this.#e.unshift(`Ka.Title: ${t.slice(2)}`);break}case"@V":{this.#s=!0,this.#e.unshift(`Kara.Ver: ${t.slice(2)}`);break}default:this.#s?t[0]=="\\"?this.#e.unshift(`@ ${t.slice(1)}`):t[0]=="/"?this.#e.unshift(t.slice(1)):this.#e[0]+=t:(this.#e[0]=t,this.#e.unshift(""))}},this.#c[2]=function(t){this.#e.unshift(`Copyrite: ${t}`)},this.#c[3]=function(t,e){e<1&&this.#m<1&&this.#e.unshift(`TrkTitle: ${t}`)},this.#c[4]=function(t,e){e<1&&this.#m<1&&this.#e.unshift(`${C(this.#m,""," ")}Instrmnt: ${t}`)},this.#c[5]=function(t){t.trim()==""?this.#e.unshift(""):this.#e[0]+=`${t}`},this.#c[6]=function(t){this.#e.unshift(`${C(this.#m,""," ")}C.Marker: ${t}`)},this.#c[7]=function(t){this.#e.unshift(`CuePoint: ${t}`)},this.#c[32]=function(t){this.#m=t[0]+1},this.#c[33]=function(t,e){console.debug(`Track ${e} requests to get assigned to output ${t}.`),n.#X[e]=t+1},this.#c[127]=function(t,e){n.#x.run(t,e)},this.#h.add([126,127,9,1],function(){n.switchMode("gm",!0),n.#s=n.#s||!1,console.info("MIDI reset: GM")}).add([126,127,9,3],function(){n.switchMode("g2",!0),n.#s=n.#s||!1,console.info("MIDI reset: GM2")}).add([65,16,22,18,127,1],function(){n.switchMode("mt32",!0),n.#s=!1,console.info("MIDI reset: MT-32")}).add([65,16,66,18,64,0,127,0,65],function(){n.switchMode("gs",!0),n.#t[1152]=120,n.#t[3200]=120,n.#t[5248]=120,n.#t[7296]=120,n.#s=!1,n.#u.forEach(d),console.info("MIDI reset: GS")}).add([67,16,76,0,0,126,0],function(t){n.switchMode("xg",!0),n.#s=!1,console.info("MIDI reset: XG")}),this.#x.add([67,0,1],function(t,e){n.#X[e]=t[0]+1}),this.#h.add([127,127,4,1],function(t){n.switchMode("gm"),n.#v=(t[1]<<7+t[0])/163.83}),this.#h.add([67,16,76,6,0],function(t){let e=t[0];n.#b=" ".repeat(e),n.#S=Date.now()+3200,t.slice(1).forEach(function(i){n.#b+=String.fromCharCode(i)})}).add([67,16,76,7,0,0],function(t){for(n.#M=Date.now()+3200;t.length<48;)t.unshift(0);t.forEach(function(e,i){let s=Math.floor(i/16),o=i%16,r=(o*3+s)*7,c=7,a=0;for(r-=o*5,s==2&&(c=2);a<c;)n.#E[r+a]=e>>6-a&1,a++})}).add([67,16,76,2,1,0],function(t){console.info(`XG reverb type: ${f[t[0]]}${t[1]>0?" "+(t[1]+1):""}`)}).add([67,16,76,2,1,2],function(t){console.info(`XG reverb time: ${M(t)}s`)}).add([67,16,76,2,1,3],function(t){console.info(`XG reverb diffusion: ${t}`)}).add([67,16,76,2,1,4],function(t){console.info(`XG reverb initial delay: ${t}`)}).add([67,16,76,2,1,5],function(t){console.info(`XG reverb high pass cutoff: ${g[t[0]]}Hz`)}).add([67,16,76,2,1,6],function(t){console.info(`XG reverb low pass cutoff: ${g[t[0]]}Hz`)}).add([67,16,76,2,1,7],function(t){console.info(`XG reverb width: ${t}`)}).add([67,16,76,2,1,8],function(t){console.info(`XG reverb height: ${t}`)}).add([67,16,76,2,1,9],function(t){console.info(`XG reverb depth: ${t}`)}).add([67,16,76,2,1,10],function(t){console.info(`XG reverb wall type: ${t}`)}).add([67,16,76,2,1,11],function(t){console.info(`XG reverb dry/wet: ${t[0]}`)}).add([67,16,76,2,1,12],function(t){console.info(`XG reverb return: ${t}`)}).add([67,16,76,2,1,13],function(t){console.info(`XG reverb pan: ${t[0]-64}`)}).add([67,16,76,2,1,16],function(t){console.info(`XG reverb delay: ${t}`)}).add([67,16,76,2,1,17],function(t){console.info(`XG density: ${t}`)}).add([67,16,76,2,1,18],function(t){console.info(`XG reverb balance: ${t}`)}).add([67,16,76,2,1,20],function(t){console.info(`XG reverb feedback: ${t}`)}).add([67,16,76,2,1,32],function(t){console.info(`XG chorus type: ${f[t[0]]}${t[1]>0?" "+(t[1]+1):""}`)}).add([67,16,76,2,1,34],function(t){console.info(`XG chorus LFO: ${E[t[0]]}Hz`)}).add([67,16,76,2,1,35],function(t){}).add([67,16,76,2,1,36],function(t){console.info(`XG chorus feedback: ${t}`)}).add([67,16,76,2,1,37],function(t){console.info(`XG chorus delay offset: ${k(t[0])}ms`)}).add([67,16,76,2,1,39],function(t){console.info(`XG chorus low: ${g[t[0]]}Hz`)}).add([67,16,76,2,1,40],function(t){console.info(`XG chorus low: ${t[0]-64}dB`)}).add([67,16,76,2,1,41],function(t){console.info(`XG chorus high: ${g[t[0]]}Hz`)}).add([67,16,76,2,1,42],function(t){console.info(`XG chorus high: ${t[0]-64}dB`)}).add([67,16,76,2,1,43],function(t){console.info(`XG chorus dry/wet: ${t}`)}).add([67,16,76,2,1,44],function(t){console.info(`XG chorus return: ${t}`)}).add([67,16,76,2,1,45],function(t){console.info(`XG chorus pan: ${t[0]-64}`)}).add([67,16,76,2,1,46],function(t){console.info(`XG chorus to reverb: ${t}`)}).add([67,16,76,2,1,64],function(t){console.info(`XG variation type: ${f[t[0]]}${t[1]>0?" "+(t[1]+1):""}`)}).add([67,16,76,2,1,66],function(t){console.info(`XG variation 1: ${t}`)}).add([67,16,76,2,1,68],function(t){console.info(`XG variation 2: ${t}`)}).add([67,16,76,2,1,70],function(t){console.info(`XG variation 3: ${t}`)}).add([67,16,76,2,1,72],function(t){console.info(`XG variation 4: ${t}`)}).add([67,16,76,2,1,74],function(t){console.info(`XG variation 5: ${t}`)}).add([67,16,76,2,1,76],function(t){console.info(`XG variation 6: ${t}`)}).add([67,16,76,2,1,78],function(t){console.info(`XG variation 7: ${t}`)}).add([67,16,76,2,1,80],function(t){console.info(`XG variation 8: ${t}`)}).add([67,16,76,2,1,82],function(t){console.info(`XG variation 9: ${t}`)}).add([67,16,76,2,1,84],function(t){console.info(`XG variation 10: ${t}`)}).add([67,16,76,2,1,86],function(t){console.info(`XG variation return: ${h(t[0])}dB`)}).add([67,16,76,2,1,87],function(t){console.info(`XG variation pan: ${t[0]-64}`)}).add([67,16,76,2,1,88],function(t){console.info(`XG variation to reverb: ${h(t[0])}dB`)}).add([67,16,76,2,1,89],function(t){console.info(`XG variation to chorus: ${h(t[0])}dB`)}).add([67,16,76,2,1,90],function(t){console.info(`XG variation connection: ${t[0]?"system":"insertion"}`)}).add([67,16,76,2,1,91],function(t){console.info(`XG variation part: ${t}`)}).add([67,16,76,2,1,92],function(t){console.info(`XG variation mod wheel: ${t[0]-64}`)}).add([67,16,76,2,1,93],function(t){console.info(`XG variation bend wheel: ${t[0]-64}`)}).add([67,16,76,2,1,94],function(t){console.info(`XG variation channel after touch: ${t[0]-64}`)}).add([67,16,76,2,1,95],function(t){console.info(`XG variation AC1: ${t[0]-64}`)}).add([67,16,76,2,1,96],function(t){console.info(`XG variation AC2: ${t[0]-64}`)}).add([67,16,76,8],function(t,e){n.#C.run(t.slice(1),n.chRedir(t[0],e))}).add([67,16,76,48],function(t){n.#g.run(t.slice(1),0,t[0])}).add([67,16,76,49],function(t){n.#g.run(t.slice(1),1,t[0])}).add([67,16,76,50],function(t){n.#g.run(t.slice(1),2,t[0])}).add([67,16,76,51],function(t){n.#g.run(t.slice(1),3,t[0])}),this.#h.add([65,1],function(t){n.switchMode("mt32"),n.#a.run(t,1)}).add([65,2],function(t){n.switchMode("mt32"),n.#a.run(t,2)}).add([65,3],function(t){n.switchMode("mt32"),n.#a.run(t,3)}).add([65,4],function(t){n.switchMode("mt32"),n.#a.run(t,4)}).add([65,5],function(t){n.switchMode("mt32"),n.#a.run(t,5)}).add([65,6],function(t){n.switchMode("mt32"),n.#a.run(t,6)}).add([65,7],function(t){n.switchMode("mt32"),n.#a.run(t,7)}).add([65,8],function(t){n.switchMode("mt32"),n.#a.run(t,8)}).add([65,9],function(t){n.switchMode("mt32"),n.#l[9]=1,n.#a.run(t,9)}),this.#a.add([22,18,2,0,0],function(t,e){let i="";t.slice(0,10).forEach(function(s){s>31&&(i+=String.fromCharCode(s))}),n.#k[e]=i,console.debug(`MT-32 tone properties on channel ${e+1} (${i}): ${t.slice(10)}`)}),this.#h.add([65,16,66,18,0,0,127],function(t){n.switchMode("gs",!0),n.#t[1152]=120,n.#t[3200]=120,n.#t[5248]=120,n.#t[7296]=120,n.#u.forEach(d),n.#s=!1,n.#w=3,console.info(`GS system set to ${t[0]?"dual":"single"} mode.`)}).add([65,16,66,18,64,0,0],function(t){}).add([65,16,66,18,64,0,4],function(t){n.#v=t[0]*129/163.83}).add([65,16,66,18,64,0,5],function(t){console.info(`GS master key shift: ${t[0]-64} semitones.`)}).add([65,16,66,18,64,0,6],function(t){console.info(`GS master pan:${t[0]-64}.`)}).add([65,16,66,18,64,1,48],function(t){console.info(`GS reverb type: ${R[t[0]]}`)}).add([65,16,66,18,64,1,49],function(t){}).add([65,16,66,18,64,1,50],function(t){console.info(`GS reverb pre-LPF: ${t[0]}`)}).add([65,16,66,18,64,1,51],function(t){console.info(`GS reverb level: ${t[0]}`)}).add([65,16,66,18,64,1,52],function(t){console.info(`GS reverb time: ${t[0]}`)}).add([65,16,66,18,64,1,53],function(t){console.info(`GS reverb delay feedback: ${t[0]}`)}).add([65,16,66,18,64,1,55],function(t){console.info(`GS reverb pre-delay time: ${t[0]}`)}).add([65,16,66,18,64,1,56],function(t){console.info(`GS chorus type: ${y[t[0]]}`)}).add([65,16,66,18,64,1,57],function(t){console.info(`GS chorus pre-LPF: ${t[0]}`)}).add([65,16,66,18,64,2,0],function(t){console.info(`GS EQ low: ${t[0]?400:200}Hz`)}).add([65,16,66,18,64,2,1],function(t){console.info(`GS EQ low: ${t[0]-64}dB`)}).add([65,16,66,18,64,2,2],function(t){console.info(`GS EQ high: ${t[0]?6e3:3e3}Hz`)}).add([65,16,66,18,64,2,3],function(t){console.info(`GS EQ high: ${t[0]-64}dB`)}).add([65,16,66,18,64,3],function(t){}).add([65,16,69,18,16,0],function(t){let e=t[0];n.#b=" ".repeat(e),n.#S=Date.now()+3200,t.pop(),t.slice(1).forEach(function(i){n.#b+=String.fromCharCode(i)})}).add([65,16,69,18,16,1,0],function(t){n.#M=Date.now()+3200,t.forEach(function(e,i){if(i<64){let s=Math.floor(i/16),o=i%16,r=(o*4+s)*5,c=5,a=0;for(r-=o*4,s==3&&(c=1);a<c;)n.#E[r+a]=e>>4-a&1,a++}})}).add([65,16,66,18,64,16],function(t,e){n.#i.run(t,n.chRedir(9,e,!0))}).add([65,16,66,18,64,17],function(t,e){n.#i.run(t,n.chRedir(0,e,!0))}).add([65,16,66,18,64,18],function(t,e){n.#i.run(t,n.chRedir(1,e,!0))}).add([65,16,66,18,64,19],function(t,e){n.#i.run(t,n.chRedir(2,e,!0))}).add([65,16,66,18,64,20],function(t,e){n.#i.run(t,n.chRedir(3,e,!0))}).add([65,16,66,18,64,21],function(t,e){n.#i.run(t,n.chRedir(4,e,!0))}).add([65,16,66,18,64,22],function(t,e){n.#i.run(t,n.chRedir(5,e,!0))}).add([65,16,66,18,64,23],function(t,e){n.#i.run(t,n.chRedir(6,e,!0))}).add([65,16,66,18,64,24],function(t,e){n.#i.run(t,n.chRedir(7,e,!0))}).add([65,16,66,18,64,25],function(t,e){n.#i.run(t,n.chRedir(8,e,!0))}).add([65,16,66,18,64,26],function(t,e){n.#i.run(t,n.chRedir(10,e,!0))}).add([65,16,66,18,64,27],function(t,e){n.#i.run(t,n.chRedir(11,e,!0))}).add([65,16,66,18,64,28],function(t,e){n.#i.run(t,n.chRedir(12,e,!0))}).add([65,16,66,18,64,29],function(t,e){n.#i.run(t,n.chRedir(13,e,!0))}).add([65,16,66,18,64,30],function(t,e){n.#i.run(t,n.chRedir(14,e,!0))}).add([65,16,66,18,64,31],function(t,e){n.#i.run(t,n.chRedir(15,e,!0))}).add([65,16,66,18,64,64],function(t,e){n.#o.run(t,n.chRedir(9,e,!0))}).add([65,16,66,18,64,65],function(t,e){n.#o.run(t,n.chRedir(0,e,!0))}).add([65,16,66,18,64,66],function(t,e){n.#o.run(t,n.chRedir(1,e,!0))}).add([65,16,66,18,64,67],function(t,e){n.#o.run(t,n.chRedir(2,e,!0))}).add([65,16,66,18,64,68],function(t,e){n.#o.run(t,n.chRedir(3,e,!0))}).add([65,16,66,18,64,69],function(t,e){n.#o.run(t,n.chRedir(4,e,!0))}).add([65,16,66,18,64,70],function(t,e){n.#o.run(t,n.chRedir(5,e,!0))}).add([65,16,66,18,64,71],function(t,e){n.#o.run(t,n.chRedir(6,e,!0))}).add([65,16,66,18,64,72],function(t,e){n.#o.run(t,n.chRedir(7,e,!0))}).add([65,16,66,18,64,73],function(t,e){n.#o.run(t,n.chRedir(8,e,!0))}).add([65,16,66,18,64,74],function(t,e){n.#o.run(t,n.chRedir(10,e,!0))}).add([65,16,66,18,64,75],function(t,e){n.#o.run(t,n.chRedir(11,e,!0))}).add([65,16,66,18,64,76],function(t,e){n.#o.run(t,n.chRedir(12,e,!0))}).add([65,16,66,18,64,77],function(t,e){n.#o.run(t,n.chRedir(13,e,!0))}).add([65,16,66,18,64,78],function(t,e){n.#o.run(t,n.chRedir(14,e,!0))}).add([65,16,66,18,64,79],function(t,e){n.#o.run(t,n.chRedir(15,e,!0))}),n.#h.add([66,48,54,104],function(t,e){n.switchMode("x5d",!0),m(t,function(i,s){if(s<192){let o=n.chRedir(Math.floor(s/12),e,!0),r=o*128;switch(s%12){case 0:{n.#$[o]=i,i>0&&(n.#l[o]=1);break}case 1:{n.#t[r+7]=i;break}case 2:{n.#d[o*4+3]=i>127?256-i:64+i;break}case 3:{n.#d[o*4+1]=i>127?256-i:64+i;break}case 4:{i<31&&(n.#t[r+10]=Math.round((i-15)*4.2+64));break}case 5:{let c=i>>4,a=i&15;n.#t[r+91]=b(a),n.#t[r+93]=b(c);break}case 10:{n.#t[r]=i&3?82:56;break}case 11:{let c=i&15,a=i>>4;n.#G[o]=c,(c!=o||a)&&console.debug(`X5D CH${o+1} requested to receive from CH${c+1}. Track is ${a?"inactive":"active"}.`)}}}else{let o=n.chRedir(s-192,e,!0)}})}).add([66,48,54,76,0],function(t,e){n.switchMode("x5d",!0);let i="",s=82,o=0,r=0,c="MSB	PRG	LSB	NME";m(t,function(a,l){if(l<16400){let u=l%164;switch(!0){case u<10:{a>31&&(i+=String.fromCharCode(a));break}case u==11:{c+=`
${s}	${o}	${r}	${i.trim().replace("Init Voice","")}`,o++,i="";break}}o>99&&(s=90,o=0)}}),n.dispatchEvent("mapupdate",{clearRange:{msb:82,prg:[0,99],lsb:0},voiceMap:c})}).add([66,48,54,77,0],function(t,e){n.switchMode("x5d",!0);let i="",s=90,o=0,r=0,c="MSB	PRG	LSB	NME";m(t,function(a,l){if(l<13600){let u=l%136;switch(!0){case u<10:{a>31&&(i+=String.fromCharCode(a));break}case u==11:{c+=`
${s}	${o}	${r}	${i.trim().replace("Init Combi","")}`,o++,i="";break}}}}),n.dispatchEvent("mapupdate",{clearRange:{msb:90,prg:[0,99],lsb:0},voiceMap:c})}).add([66,48,66,54],function(t,e){n.switchMode("ns5r",!0);let i="",s=80,o=0,r=0,c="MSB	PRG	LSB	NME";m(t,function(a,l){let u=l%158;switch(!0){case u<10:{a>31&&(i+=String.fromCharCode(a));break}case u==11:{s=a;break}case u==12:{r=a;break}case u==13:{c+=`
${s}	${o}	${r}	${i.trim()}`,o++,i="";break}}}),n.dispatchEvent("mapupdate",{clearRange:{msb:80,lsb:0},voiceMap:c})}).add([66,48,66,52],function(t){n.switchMode("ns5r",!0),n.#s=!1}).add([66,48,66,53],function(t){n.switchMode("ns5r",!0),m(t,function(e,i){switch(!0){case i<2944:{let s=Math.floor(i/92),o=s*128;switch(i%92){case 0:{n.#t[o]=e;break}case 1:{n.#t[o+32]=e;break}case 2:{n.#$[s]=e,e>0&&(n.#l[s]=1);break}case 3:s!=e&&console.debug(`NS5R CH${s+1} requested to receive from CH${e+1}.`);case 7:break;case 8:{n.#d[s*4+3]=e;break}case 9:case 10:{n.#t[o+7]=e;break}case 11:{n.#t[o+11]=e;break}case 14:{n.#t[o+10]=e||128;break}case 19:{n.#t[o+93]=e;break}case 20:{n.#t[o+91]=e;break}case 84:{n.#t[o+65]=e;break}case 85:{n.#t[o+5]=e;break}}break}case i<3096:break;case i<3134:break;case i<8566:break}})}),n.#g.add([0],function(t,e,i){console.info(`XG Drum ${e} note ${i} coarse pitch bend ${t[0]-64}.`)}).add([1],function(t,e,i){console.info(`XG Drum ${e} note ${i} fine pitch bend ${t[0]-64}.`)}).add([2],function(t,e,i){console.info(`XG Drum ${e} note ${i} level ${t[0]}.`)}).add([3],function(t,e,i){console.info(`XG Drum ${e} note ${i} alt group ${t[0]}.`)}).add([4],function(t,e,i){console.info(`XG Drum ${e} note ${i} pan ${t[0]-64}.`)}).add([5],function(t,e,i){console.info(`XG Drum ${e} note ${i} reverb send ${h(t[0])}dB.`)}).add([6],function(t,e,i){console.info(`XG Drum ${e} note ${i} chorus send ${h(t[0])}dB.`)}).add([7],function(t,e,i){console.info(`XG Drum ${e} note ${i} variation send ${h(t[0])}dB.`)}).add([8],function(t,e,i){console.info(`XG Drum ${e} note ${i} key assign as ${t[0]>0?"multi":"single"}.`)}).add([9],function(t,e,i){}).add([10],function(t,e,i){}).add([11],function(t,e,i){}).add([12],function(t,e,i){}).add([13],function(t,e,i){}).add([14],function(t,e,i){}).add([15],function(t,e,i){}),n.#C.add([0],function(t,e){console.info(`XG Part reserve ${t[0]} elements for channel ${e}.`)}).add([1],function(t,e){n.#t[e*128]=t[0]}).add([2],function(t,e){n.#t[e*128+32]=t[0]}).add([3],function(t,e){n.#$[e]=t[0]}).add([4],function(t,e){console.info(`XG Part send CH${e} to CH${t[0]}. Channel redirect feature required!`)}).add([5],function(t,e){console.info(`XG Part mono/poly set to ${t[0]?"mono":"poly"} for channel ${e}.`)}).add([6],function(t,e){console.info(`XG Part repeat pressing set to ${["single","multi","inst"][t[0]]} mode for channel ${e}.`)}).add([7],function(t,e){let i=t[0];n.#t[128*e]=i>1?127:0,console.info(`XG Part use mode "${X[i]}" for channel ${e}.`)}).add([14],function(t,e){n.#t[128*e+10]=t[0]||128}).add([17],function(t,e){console.info(`XG Part dry level ${t[0]} for channel ${e}.`)}).add([18],function(t,e){console.info(`XG Part chorus send ${h(t[0])}dB for channel ${e}.`)}).add([19],function(t,e){console.info(`XG Part reverb send ${h(t[0])}dB for channel ${e}.`)}).add([20],function(t,e){console.info(`XG Part variation send ${h(t[0])}dB for channel ${e}.`)}).add([21],function(t,e){console.info(`XG Part LFO speed ${t[0]} for channel ${e}.`)}).add([29],function(t,e){console.info(`XG Part MW bend ${t[0]-64} semitones for channel ${e}.`)}).add([32],function(t,e){console.info(`XG Part MW LFO pitch depth ${t[0]} for channel ${e}.`)}).add([33],function(t,e){console.info(`XG Part MW LFO filter depth ${t[0]} for channel ${e}.`)}).add([35],function(t,e){console.info(`XG Part bend pitch ${t[0]-64} semitones for channel ${e}.`)}).add([83],function(t,e){}).add([103],function(t,e){n.#t[e*128+65]=t[0]}).add([104],function(t,e){n.#t[e*128+5]=t[0]}).add([105],function(t,e){console.info(`XG Part EG initial ${t[0]-64} for channel ${e}.`)}).add([106],function(t,e){console.info(`XG Part EG attack time ${t[0]-64} for channel ${e}.`)}),n.#i.add([0],function(t,e){n.#t[e*128]==120&&(t[0]=120),n.#t[e*128]=t[0]||0,n.#$[e]=t[1]||0}).add([2],function(t,e){}).add([19],function(t,e){}).add([20],function(t,e){}).add([21],function(t,e){console.info(`GS Part ${e+1} type: ${["melodic","drum 1","drum 2"][t[0]]}.`),t[0]>0&&(n.#t[e*128]=120)}).add([25],function(t,e){n.#t[e*128+7]=t[0]}).add([28],function(t,e){n.#t[e*128+10]=t[0]||128}).add([33],function(t,e){n.#t[e*128+93]=t[0]}).add([34],function(t,e){n.#t[e*128+91]=t[0]}),n.#o.add([0],function(t,e){n.#t[e*128+32]=t[0]}).add([1],function(t,e){n.#t[e*128+32]=t[0]}).add([32],function(t,e){console.info(`GS Part ${e+1} turned EQ ${t[0]?"on":"off"}.`)}).add([33],function(t,e){}).add([34],function(t,e){console.info(`GS Part ${e+1} turned EFX ${t[0]?"on":"off"}.`)})}};export{V as OctaviaDevice};
