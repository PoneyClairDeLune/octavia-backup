var o=["?","gm","gs","xg","mt32","ns5r","ag10","x5d","05rw"],h={};o.forEach(function(t,i){h[t]=i});var s=function(t,i,e){e[i]=0},u=class{#n=0;#e=new Array(64);#s=new Uint8ClampedArray(8192);#o=new Uint8ClampedArray(64);#i=new Uint8ClampedArray(8192);#t=new Uint16Array(512);#r=new Int16Array(64);#a=0;#h=0;#l={8:function(t){let i=t.part*128+t.data[0],e=this.#t.indexOf(i);e>-1&&(this.#t[e]=0,this.#i[i]=0)},9:function(t){this.#e[t.part]=!0;let i=t.part*128+t.data[0];if(t.data[1]>0){let e=0;for(;this.#t[e]>0;)e++;e<512?(this.#t[e]=i,this.#i[i]=t.data[1]):console.error("Polyphony exceeded.")}else{let e=this.#t.indexOf(i);e>-1&&(this.#t[e]=0,this.#i[i]=0)}},10:function(t){let i=t.part*128+t.data[0];this.#t.indexOf(i)>-1&&(this.#i[i]=data[1])},11:function(t){this.#e[t.part]=!0,this.#s[t.part*128+t.data[0]]=t.data[1]},12:function(t){this.#e[t.part]=!0,this.#o[t.part]=t.data},13:function(t){let i=this;this.#t.forEach(function(e){let n=e>>7;t.part==n&&(this.#i[e]=t.data)}),console.info(t)},14:function(t){this.#r[t.part]=t.data[1]*128+t.data[0]},15:function(t){console.warn(t)},255:function(t){console.warn(t)}};getActive(){return this.#e.slice()}getCc(t){let i=t*128;return Array.from(this.#s).slice(i,i+128)}getPitch(){return Array.from(this.#r)}getProgram(){return Array.from(this.#o)}getVel(t){let i=new Map,e=this;return this.#t.forEach(function(n){let r=n>>7,a=n&127;t==r&&e.#i[n]>0&&i.set(a,e.#i[n])}),i}getMode(){return o[this.#n]}init(){this.#n=0,this.#a=0,this.#h=0,this.#e.forEach(s),this.#s.forEach(s),this.#o.forEach(s),this.#i.forEach(s),this.#t.forEach(s)}switchMode(t,i=!1){let e=o.indexOf(t);if(e>-1)(this.#n==0||i)&&(this.#n=e);else throw new Error(`Unknown mode ${t}`)}runJson(t){this.#l[t.type].call(this,t)}runRaw(t){}};export{u as OctaviaDevice};
