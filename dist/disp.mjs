var G=Object.create;var b=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var F=Object.getPrototypeOf,X=Object.prototype.hasOwnProperty;var j=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var K=(t,n,e,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let i of V(n))!X.call(t,i)&&i!==e&&b(t,i,{get:()=>n[i],enumerable:!(r=N(n,i))||r.enumerable});return t};var z=(t,n,e)=>(e=t!=null?G(F(t)):{},K(n||!t||!t.__esModule?b(e,"default",{value:t,enumerable:!0}):e,t));var $=j((ct,k)=>{(function(){"use strict";let t={debug:!1,parse:function(n,e){if(n instanceof Uint8Array)return t.Uint8(n);if(typeof n=="string")return t.Base64(n);if(n instanceof HTMLElement&&n.type==="file")return t.addListener(n,e);throw new Error("MidiParser.parse() : Invalid input provided")},addListener:function(n,e){if(!File||!FileReader)throw new Error("The File|FileReader APIs are not supported in this browser. Use instead MidiParser.Base64() or MidiParser.Uint8()");if(n===void 0||!(n instanceof HTMLElement)||n.tagName!=="INPUT"||n.type.toLowerCase()!=="file")return console.warn("MidiParser.addListener() : Provided element is not a valid FILE INPUT element"),!1;e=e||function(){},n.addEventListener("change",function(r){if(!r.target.files.length)return!1;console.log("MidiParser.addListener() : File detected in INPUT ELEMENT processing data..");let i=new FileReader;i.readAsArrayBuffer(r.target.files[0]),i.onload=function(a){e(t.Uint8(new Uint8Array(a.target.result)))}})},Base64:function(n){let e=function(a){var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";if(a=a.replace(/^.*?base64,/,""),a=String(a).replace(/[\t\n\f\r ]+/g,""),!/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/.test(a))throw new TypeError("Failed to execute _atob() : The string to be decoded is not correctly encoded.");a+="==".slice(2-(3&a.length));let f,c="",s,l,h=0;for(;h<a.length;)f=o.indexOf(a.charAt(h++))<<18|o.indexOf(a.charAt(h++))<<12|(s=o.indexOf(a.charAt(h++)))<<6|(l=o.indexOf(a.charAt(h++))),c+=s===64?String.fromCharCode(f>>16&255):l===64?String.fromCharCode(f>>16&255,f>>8&255):String.fromCharCode(f>>16&255,f>>8&255,255&f);return c}(n=String(n));var r=e.length;let i=new Uint8Array(new ArrayBuffer(r));for(let a=0;a<r;a++)i[a]=e.charCodeAt(a);return t.Uint8(i)},Uint8:function(i){let e={data:null,pointer:0,movePointer:function(s){return this.pointer+=s,this.pointer},readInt:function(s){if((s=Math.min(s,this.data.byteLength-this.pointer))<1)return-1;let l=0;if(1<s)for(let h=1;h<=s-1;h++)l+=this.data.getUint8(this.pointer)*Math.pow(256,s-h),this.pointer++;return l+=this.data.getUint8(this.pointer),this.pointer++,l},readStr:function(s){let l="";for(let h=1;h<=s;h++)l+=String.fromCharCode(this.readInt(1));return l},backOne:function(){this.pointer--},readIntVLV:function(){let s=0;if(this.pointer>=this.data.byteLength)return-1;if(this.data.getUint8(this.pointer)<128)s=this.readInt(1);else{let h=[];for(;128<=this.data.getUint8(this.pointer);)h.push(this.readInt(1)-128);var l=this.readInt(1);for(let u=1;u<=h.length;u++)s+=h[h.length-u]*Math.pow(128,u);s+=l}return s}};if(e.data=new DataView(i.buffer,i.byteOffset,i.byteLength),e.readInt(4)!==1297377380)return console.warn("Header validation failed (not MIDI standard or file corrupt.)"),!1;e.readInt(4);let r={};r.formatType=e.readInt(2),r.tracks=e.readInt(2),r.track=[];var i=e.readInt(1),a=e.readInt(1);128<=i?(r.timeDivision=[],r.timeDivision[0]=i-128,r.timeDivision[1]=a):r.timeDivision=256*i+a;for(let s=1;s<=r.tracks;s++){r.track[s-1]={event:[]};var o,f=e.readInt(4);if(f===-1)break;if(f!==1297379947)return!1;e.readInt(4);let l=0,h=!1,u,d;for(;!h&&(l++,r.track[s-1].event[l-1]={},r.track[s-1].event[l-1].deltaTime=e.readIntVLV(),(u=e.readInt(1))!==-1);)if(128<=u?d=u:(u=d,e.movePointer(-1)),u===255){r.track[s-1].event[l-1].type=255,r.track[s-1].event[l-1].metaType=e.readInt(1);var c=e.readIntVLV();switch(r.track[s-1].event[l-1].metaType){case 47:case-1:h=!0;break;case 1:case 2:case 3:case 4:case 5:case 7:case 6:r.track[s-1].event[l-1].data=e.readStr(c);break;case 33:case 89:case 81:r.track[s-1].event[l-1].data=e.readInt(c);break;case 84:r.track[s-1].event[l-1].data=[],r.track[s-1].event[l-1].data[0]=e.readInt(1),r.track[s-1].event[l-1].data[1]=e.readInt(1),r.track[s-1].event[l-1].data[2]=e.readInt(1),r.track[s-1].event[l-1].data[3]=e.readInt(1),r.track[s-1].event[l-1].data[4]=e.readInt(1);break;case 88:r.track[s-1].event[l-1].data=[],r.track[s-1].event[l-1].data[0]=e.readInt(1),r.track[s-1].event[l-1].data[1]=e.readInt(1),r.track[s-1].event[l-1].data[2]=e.readInt(1),r.track[s-1].event[l-1].data[3]=e.readInt(1);break;default:this.customInterpreter!==null&&(r.track[s-1].event[l-1].data=this.customInterpreter(r.track[s-1].event[l-1].metaType,e,c)),this.customInterpreter!==null&&r.track[s-1].event[l-1].data!==!1||(e.readInt(c),r.track[s-1].event[l-1].data=e.readInt(c),this.debug&&console.info("Unimplemented 0xFF meta event! data block readed as Integer"))}}else switch((u=u.toString(16).split(""))[1]||u.unshift("0"),r.track[s-1].event[l-1].type=parseInt(u[0],16),r.track[s-1].event[l-1].channel=parseInt(u[1],16),r.track[s-1].event[l-1].type){case 15:this.customInterpreter!==null&&(r.track[s-1].event[l-1].data=this.customInterpreter(r.track[s-1].event[l-1].type,e,!1)),this.customInterpreter!==null&&r.track[s-1].event[l-1].data!==!1||(o=e.readIntVLV(),r.track[s-1].event[l-1].data=e.readInt(o),this.debug&&console.info("Unimplemented 0xF exclusive events! data block readed as Integer"));break;case 10:case 11:case 14:case 8:case 9:r.track[s-1].event[l-1].data=[],r.track[s-1].event[l-1].data[0]=e.readInt(1),r.track[s-1].event[l-1].data[1]=e.readInt(1);break;case 12:case 13:r.track[s-1].event[l-1].data=e.readInt(1);break;case-1:h=!0;break;default:if(this.customInterpreter!==null&&(r.track[s-1].event[l-1].data=this.customInterpreter(r.track[s-1].event[l-1].metaType,e,!1)),this.customInterpreter===null||r.track[s-1].event[l-1].data===!1)return console.log("Unknown EVENT detected... reading cancelled!"),!1}}return r},customInterpreter:null};if(typeof k<"u")k.exports=t;else{let n=typeof window=="object"&&window.self===window&&window||typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global;n.MidiParser=t}})()});var v=class{#t={};addEventListener(t,n){this.#t[t]||(this.#t[t]=[]),this.#t[t].unshift(n)}removeEventListener(t,n){if(this.#t[t]){let e=this.#t[t].indexOf(n);e>-1&&this.#t[t].splice(e,1),this.#t[t].length<1&&delete this.#t[t]}}dispatchEvent(t,n){let e=new Event(t),r=this;e.data=n,this.#t[t]?.length>0&&this.#t[t].forEach(function(i){i?.call(r,e)}),this[`on${t}`]&&this[`on${t}`](e)}};var T=function(t,n){let e=Math.min(t.length,n.length),r=t.slice(0,e),i=n.slice(0,e),a=0,o=0;for(;o<e&&a==0;)a=Math.sign(r[o]-i[o]),o++;return a},A=function(){this.pool=[],this.point=function(t,n=!1){if(this.pool.length>0){let e=this.pool.length,r=1<<Math.floor(Math.log2(e)),i=r,a=64;for(;r>=1&&a>=0;){if(a<=0)throw new Error("TTL reached.");if(i==e)i-=r;else{let f=T(t,this.pool[i]);switch(f){case 0:{a=0;break}case 1:{i+r<=e&&(i+=r);break}case-1:{i!=0&&(i-=r);break}default:console.warn(`Unexpected result ${f}.`)}}r=r>>1,a--}let o=!0;if(i>=this.pool.length)o=!1;else{let f=this;this.pool[i].forEach(function(c,s,l){o&&c!=t[s]&&(o=!1)}),!o&&T(t,this.pool[i])>0&&i++}return o||n?i:-1}else return n?0:-1},this.add=function(t,n){return t.data=n,this.pool.splice(this.point(t,!0),0,t),this},this.default=function(t){console.warn(`No match for "${t}". Default action not defined.`)},this.get=function(t){let n=this.point(t);if(n>-1)return this.pool[n].data;this.default(t)},this.run=function(t,...n){let e=this.point(t);e>-1?this.pool[e].data(t.slice(this.pool[e].length),...n):this.default(t,...n)}};var E=["?","gm","gs","xg","g2","mt32","ns5r","ag10","x5d","05rw"],P={};E.forEach(function(t,n){P[t]=n});var C=[[0,0,0,0,0,0,0,56,82,81],[0,0,0,0,0,127,0,0,0,0]],Z=[0,3,4,5,6,7,81,84,88,89],g=function(t,n,e){e[n]=0},H=function(t){let n=[[]];return t?.forEach(function(e){e==247||(e==240?n.push([]):n[n.length-1].push(e))}),n},S=class extends v{#t=0;#i=new Array(256);#n=0;#a=new Array(64);#r=new Uint8ClampedArray(8192);#f=new Uint8ClampedArray(64);#s=new Uint8ClampedArray(8192);#e=new Uint16Array(512);#m=new Int16Array(64);#d=0;#u=0;#p=100;#c="";#g=0;#h=[];#v={8:function(t){let n=t.part*128+t.data[0],e=this.#e.indexOf(n);e>-1&&(this.#e[e]=0,this.#s[n]=0)},9:function(t){this.#a[t.part]=!0;let n=t.part*128+t.data[0];if(t.data[1]>0){let e=0;for(;this.#e[e]>0;)e++;e<512?(this.#e[e]=n,this.#s[n]=t.data[1]):console.error("Polyphony exceeded.")}else{let e=this.#e.indexOf(n);e>-1&&(this.#e[e]=0,this.#s[n]=0)}},10:function(t){let n=t.part*128+t.data[0];this.#e.indexOf(n)>-1&&(this.#s[n]=data[1])},11:function(t){this.#a[t.part]=!0,t.data[0]==0&&t.part%16==9&&this.#t==P.gs&&(t.data[1]=120),this.#r[t.part*128+t.data[0]]=t.data[1]},12:function(t){this.#a[t.part]=!0,this.#f[t.part]=t.data},13:function(t){let n=this;this.#e.forEach(function(e){let r=e>>7;t.part==r&&(this.#s[e]=t.data)}),console.info(t)},14:function(t){this.#m[t.part]=t.data[1]*128+t.data[0]-8192},15:function(t){let n=this;H(t.data).forEach(function(e){n.#o.run(e)})},255:function(t){if((this.#h[t.meta]||console.debug).call(this,t.data),Z.indexOf(t.meta)>-1)return t.reply="meta",t;self.debugMode&&console.debug(t)}};#o;#w;#l=[];getActive(){return this.#a.slice()}getCc(t){let n=t*128,e=Array.from(this.#r).slice(n,n+128);return e[0]=e[0]||this.#d,e[32]=e[32]||this.#u,e}getPitch(){return Array.from(this.#m)}getProgram(){return Array.from(this.#f)}getTexts(){return this.#l.slice()}getVel(t){let n=new Map,e=this;return this.#e.forEach(function(r){let i=r>>7,a=r&127;t==i&&e.#s[r]>0&&n.set(a,e.#s[r])}),n}getBitmap(){return{bitmap:this.#i.slice(),expire:this.#n}}getLetter(){return{text:this.#c,expire:this.#g}}getMode(){return E[this.#t]}getMaster(){return{volume:this.#p}}init(){this.dispatchEvent("mode","?"),this.#t=0,this.#d=0,this.#u=0,this.#a.forEach(g),this.#r.forEach(g),this.#f.forEach(g),this.#s.forEach(g),this.#e.forEach(g),this.#p=100,this.#l=[],this.#g=0,this.#c="",this.#n=0,this.#i.forEach(g),this.#r[1152]=127;for(let t=0;t<64;t++)this.#r[t*128+7]=127,this.#r[t*128+11]=127,this.#r[t*128+74]=127,this.#r[t*128+10]=127}switchMode(t,n=!1){let e=E.indexOf(t);if(e>-1)(this.#t==0||n)&&(this.#t=e,this.#d=C[0][e],this.#u=C[1][e],this.dispatchEvent("mode",t));else throw new Error(`Unknown mode ${t}`)}runJson(t){return this.#v[t.type].call(this,t)}runRaw(t){}constructor(){super();let t=this;self.seeReg=function(n){return Array.from(t.#r).slice(n*128,n*128+128)},this.#o=new A,this.#o.default=console.debug,this.#h[1]=function(n){this.#l.unshift(n)},this.#h[2]=function(n){this.#l.unshift(`Copyrite: ${n}`)},this.#h[3]=function(n){this.#l.unshift(`Trk.Info: ${n}`)},this.#o.add([126,127,9,1],function(){t.switchMode("gm",!0),console.info("MIDI reset: GM")}).add([126,127,9,3],function(){t.switchMode("g2",!0),console.info("MIDI reset: GM2")}).add([65,16,22,18,127,1],function(){t.switchMode("mt32",!0),console.info("MIDI reset: MT-32")}).add([65,16,66,18,64,0,127,0,65],function(){t.switchMode("gs",!0),console.info("MIDI reset: GS")}).add([66,48,66,52,0],function(n){t.switchMode("ns5r",!0),console.info("KORG reset:",n)}).add([67,16,76,0,0,126,0],function(n){t.switchMode("xg",!0),console.info("MIDI reset: XG")}),this.#o.add([127,127,4,1],function(n){t.switchMode("gm"),t.#p=(n[1]<<7+n[0])/163.83}),this.#o.add([67,16,76,6,0],function(n){let e=n[0];t.#c=" ".repeat(e),t.#g=Date.now()+3200,n.slice(1).forEach(function(r){t.#c+=String.fromCharCode(r)})}).add([67,16,76,7,0,0],function(n){for(t.#n=Date.now()+3200;iMsg.length<48;)n.unshift(0);n.forEach(function(e,r){let i=Math.floor(r/16),a=r%16,o=(a*3+i)*7,f=7,c=0;for(o-=a*5,i==2&&(f=2);c<f;)t.#i[o+c]=e>>6-c&1,c++})}),this.#o.add([65,16,69,18,16,1,0],function(n){t.#n=Date.now()+3200,n.forEach(function(e,r){if(r<64){let i=Math.floor(r/16),a=r%16,o=(a*4+i)*5,f=5,c=0;for(o-=a*4,i==3&&(f=1);c<f;)t.#i[o+c]=e>>4-c&1,c++}})})}};var x=z($(),1);var D=class{#t=!1;constructor(t,n,e,r){this.#t=t,this.start=n,this.end=e,this.data=r}get duration(){return this.ranged?this.end-this.start:0}get ranged(){return this.#t}},y=class extends D{constructor(t,n,e){super(!0,t,n,e)}},L=class extends D{constructor(t,n){super(!1,t,t,n)}},M=class extends Array{#t=-1;constructor(){super(...arguments)}resetIndex(t){this.#t=-1}fresh(){this.sort(function(t,n){return t.start==n.start?0:(+(t.start>n.start)<<1)-1}),this.forEach(function(t,n){t.index=n})}step(t,n=!1){let e=[];if(n)for(let r=0;r<this.length&&!(this[r].start>t);r++){if(this[r].end<t)continue;e.push(this[r])}else{let r=this.getRange(t-1,t),i=this;r.forEach(function(a){a.index>i.#t&&(e.push(a),i.#t=a.index)})}return e}getRange(t,n){t>n&&([t,n]=[n,t]);let e=[],r=-1,i=Math.ceil(Math.sqrt(this.length)),a=!0;for(let o=0;o<this.length;o+=i)this[o+i]?r<0&&this[o+i].start>=t&&(r=o):r=r<0?o:r;for(;a;)this[r]?.end<n?this[r].start>=t&&e.push(this[r]):a=!1,r++;return e}};var W=0xffffffffffff,U=function(t){let n=new M,e=this,r=t.timeDivision,i=120,a=new M,o=0,f=0;a.push(new y(0,W,[120,0])),t.track.forEach(function(h){o=0,h.event.forEach(function(u){o+=u.deltaTime,u.type==255&&u?.metaType==81&&(i=6e7/u.data,a[a.length-1]&&a.push(new y(o,0xffffffffffff,[i,0])))})}),a.fresh(),a.forEach(function(h,u,d){u>0&&(d[u-1].end=h.start)});let c=120;a.forEach(function(h,u,d){h.end==h.start?d.splice(d.indexOf(h),1):c==h.data[0]&&(d[u-1].end=h.end,d.splice(d.indexOf(h),1)),c=h.data[0]});let s=0,l=120;return a.forEach(function(h){let u=h.start,d=u/l/r*60+s;l=h.data[0],s=d-u/l/r*60,h.data[1]=s}),console.debug("All tempo changes: ",a),i=120,o=0,f=0,t.track.forEach(function(h,u){o=0,f=0,h.event.forEach(function(d,m){o+=d.deltaTime;let w=a.step(o,!0)[0];w&&(i=w.data[0],f=w.data[1]);let I={type:d.type,data:d.data,track:u,part:0};d.type>14?I.meta=d.metaType:I.part=d.channel,n.push(new L(o/i/r*60+f,I))})}),n.fresh(),n};var q=["MSB","PRG","LSB"];var R=class{#t=[];get(t=0,n=0,e=0){let r,i=Array.from(arguments);i[0]==127&&i[2]==0&&i[1]>111&&(i[1]=0),i[0]==0&&i[2]>111&&i[2]<120&&(i[2]=0);let a=" ";for(;!(r?.length>0);)r=this.#t[i[1]||0][(i[0]<<7)+i[2]],r||(i[2]=0,a="^",this.#t[i[1]||0][i[0]<<7]||(i[0]=0,a="*"));a!=" "&&self.debugMode&&(r="");let o="??";switch(i[0]){case 0:{i[2]==0?o="GM":i[2]<120?o="XG":i[2]==127&&(o="MT");break}case 56:{o="AG";break}case 61:case 83:{o="AI";break}case 62:case 82:{o="XD";break}case 81:{o="RW";break}case 64:case 121:case 126:case 127:{o="XG";break}case 120:o="GS";default:i[0]<40&&(o="GS")}return{name:r||(t||0).toString().padStart(3,"0")+" "+(n||0).toString().padStart(3,"0")+" "+(e||0).toString().padStart(3,"0"),ending:a,standard:o}}load(t){let n=this,e=[];t.split(`
`).forEach(function(r,i){let a=r.split("	"),o=[];i==0?(a.forEach(function(f,c){e[q.indexOf(f)]=c}),console.info(`Bank map significance: ${e}`)):a.forEach(function(f,c){c>2?(n.#t[o[e[1]]]=n.#t[o[e[1]]]||[],n.#t[o[e[1]]][(o[e[0]]<<7)+o[e[2]]]=a[3]):o.push(parseInt(a[c]))})})}async loadFiles(...t){this.#t=[];let n=this;for(let e=0;e<t.length;e++)await fetch(`./data/bank/${t[e]}.tsv`).then(function(r){return console.info(`Parsing voice map: ${t[e]}`),r.text()}).then(function(r){n.load.call(n,r)})}constructor(...t){this.loadFiles(...t)}};var O=function(t){let n=Array.from("----");if(t>0)for(let e=0;t>0;e++)n[e]=t<1024?"=":">",t-=2048;else if(t<0)for(let e=3;t<0;e--)n[e]=t>=-1024?"=":"<",t+=2048;return n.join("")},B=function(t){let n=Array.from("----");if(t>64)for(let e=0;t>64;e++)n[e]=t<72?"=":">",t-=16;else if(t<64)for(let e=3;t<64;e--)n[e]=t>=56?"=":"<",t+=16;return n.join("")};var Y=["C~","C#","D~","Eb","E~","F~","F#","G~","Ab","A~","Bb","B~"],J="!0123456789";var p="0123456789_aAbBcCdDeEfFgGhHiIjJ-kKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ",Q=["-","~","+","|"],_={"?":"UnkwnStd",gm:"GnrlMIDI",g2:"GrlMIDI2",xg:"YamahaXG",gs:"RolandGS",mt32:"RlndMT32",ag10:"KorgAG10",x5d:"Korg X5D","05rw":"Korg05RW",ns5r:"KorgNS5R"};x.default.customInterpreter=function(t,n,e){let r=[],i=e==!1?n.readIntVLV():e;t==127&&(i=1);for(let a=0;a<i;a++){let o=n.readInt(1);if(r.push(o),o!=247){if(o!=240){if(o>127)return console.debug(`Early termination: ${r}`),n.backOne(),n.backOne(),r}}}return r};var tt=class extends v{#t=new S;#i;#n="";voices=new R("xg","gs","ns5r");#a=[];reset(){this.dispatchEvent("reset"),this.#i?.resetIndex(),this.#t.init(),this.#n=""}async loadFile(t){this.#i=U(x.default.parse(new Uint8Array(await t.arrayBuffer())))}switchMode(t,n=!1){this.#t.switchMode(t,n)}getMode(){return this.#t.mode}render(t){let n=this.#i.step(t),e=0,r=new Set,i=this,a=[];n.forEach(function(u){let d=u.data;d.type==9&&(d.data[1]>0?r.add(d.part*128+d.data[0]):r.has(d.part*128+d.data[0])&&e++),u.data.type==8&&r.has(d.part*128+d.data[0])&&e++;let m=i.#t.runJson(d);switch(m?.reply){case"meta":{a.push(m);break}}m?.reply&&delete m.reply}),a?.length>0&&this.dispatchEvent("meta",a);let o=this.#t.getActive(),f=[],c=i.#t.getPitch(),s=[],l=i.#t.getProgram(),h=0;return o.forEach(function(u,d){u&&(f[d]=i.#t.getVel(d),s[d]=i.#t.getCc(d),h+=f[d].size)}),{extraPoly:e,curPoly:h,chInUse:o,chKeyPr:f,chPitch:c,chProgr:l,chContr:s,eventCount:n.length,title:this.#n,bitmap:this.#t.getBitmap(),letter:this.#t.getLetter(),texts:this.#t.getTexts(),master:this.#t.getMaster(),mode:this.#t.getMode()}}constructor(){super();let t=this;this.addEventListener("meta",function(n){n?.data?.forEach(function(e){(t.#a[e.meta]||console.debug).call(t,e.meta,e.data)})}),this.#t.addEventListener("mode",function(n){t.dispatchEvent("mode",n.data)}),this.#a[3]=function(n,e){t.#n?.length<1&&(t.#n=e)}}},bt=class extends tt{constructor(){super()}render(t,n){let e=new Array(24),r=super.render(t),i=this,a=Date.now();e[0]=`${r.eventCount.toString().padStart(3,"0")} Poly:${(r.curPoly+r.extraPoly).toString().padStart(3,"0")}/512 Vol:${Math.floor(r.master.volume)}.${Math.round(r.master.volume%1*100).toString().padStart(2,"0")}%`,e[1]=`Mode:${_[r.mode]} Title:${r.title||"N/A"}`,e[2]="Ch:VoiceNme#St VEM RCDB PP PiBd Pan : Note";let o=3;if(r.chInUse.forEach(function(f,c){if(f){let s=i.voices.get(r.chContr[c][0],r.chProgr[c],r.chContr[c][32]);e[o]=`${(c+1).toString().padStart(2,"0")}:${s.name.padEnd(8," ")}${s.ending}${s.standard} ${p[r.chContr[c][7]>>1]}${p[r.chContr[c][11]>>1]}${Q[r.chContr[c][1]>>5]} ${p[r.chContr[c][91]>>1]}${p[r.chContr[c][93]>>1]}${p[r.chContr[c][94]>>1]}${p[r.chContr[c][74]>>1]} ${r.chContr[c][65]>63?"O":"X"}${p[r.chContr[c][5]>>1]} ${O(r.chPitch[c])} ${B(r.chContr[c][10])}:`,r.chKeyPr[c].forEach(function(l,h){l>0&&(e[o]+=` <span style="opacity:${Math.round(l/1.27)/100}">${Y[h%12]}${J[Math.floor(h/12)]}</span>`)}),o++}}),r.texts.length>0){let f=0;for(let c=e.length-1;c>=o;c--)e[c]=(r.texts[f]||"").padEnd(100," "),f++}if(a<=r.letter.expire){let f=r.letter.text.padEnd(32," "),c=e.length-2;for(let s=0;s<2;s++)e[s+c]=`${(e[s+c]||"").slice(0,82).padEnd(81)} <span class="letter"> ${f.slice(s*16,s*16+16).padEnd(" ",16)} </span>`}return n.clearRect(0,0,n.canvas.width,n.canvas.height),n&&a<=r.bitmap.expire&&(n.fillStyle="#202020",r.bitmap.bitmap.forEach(function(f,c){f&&n.fillRect(c%16*12,Math.floor(c/16)*6,10,4)})),e.join("<br/>")}};export{bt as TuiDisplay};
